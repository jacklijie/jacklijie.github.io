webpackJsonp([46],{"qq+V":function(e,t,n){"use strict";function o(){var e=location.search,t=new Object;if(-1!=e.indexOf("?"))for(var n=e.substr(1),o=n.split("&"),r=0;r<o.length;r++)t[o[r].split("=")[0]]=o[r].substr(o[r].indexOf("=")+1);return t}function r(e,t){return new l.a(function(n,o){var r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState&&(r.status>=200&&(r.status<300||304===r.status)?n(JSON.parse(r.responseText)):o("XHR unsuccessful:"+r.status))},r.open("post",e,!0),r.setRequestHeader("content-type","application/json"),r.send(u()(t))})}function c(e){var t=o(),n=t.token,c=t.empCode,m=t.cmsOrgId;if(n&&c&&m){var d=document.getElementById("searchIpt"+e).value;d?r("/wx-web/external/queryEmpInfo",{tokenId:n,empCode:c,cmsOrgId:m,message:d}).then(function(t){if("0"==t.errcode){console.log(t);var n=t.retval,o="<p>姓名："+n.empName+"<span>工号："+n.empCode+"</span></p><p>联系电话："+n.empMobile+"</p><p>网点名称："+n.orgName+"</p>";document.getElementById("empInfo"+e).innerHTML=o,document.getElementById("code"+e).value=n.empCode,document.getElementById("code"+e).setAttribute("data-empName",n.empName),document.getElementById("errMsg"+e).innerText=""}else document.getElementById("errMsg"+e).innerText=t.errmsg}).catch(function(t){console.error(t),document.getElementById("errMsg"+e).innerText="查询失败，请稍后重试"}):document.getElementById("errMsg"+e).innerText="请输入"+("From"==e?"需要换绑":"换绑后")+"的员工编号或手机号"}else alert("登录用户信息失效，请尝试重新进入")}function m(e){document.getElementById("searchIpt"+e).value="",document.getElementById("empInfo"+e).innerHTML="",document.getElementById("code"+e).value=""}function d(){document.getElementById("searchBtnFrom").onclick=function(){c("From")},document.getElementById("searchBtnTo").onclick=function(){c("To")},document.getElementById("resetBtnFrom").onclick=function(){m("From")},document.getElementById("resetBtnTo").onclick=function(){m("To")},document.getElementById("saveChangeBtn").onclick=function(){var e=document.getElementById("codeFrom").value,t=document.getElementById("codeTo").value;if(e)if(t)if(e==t)document.getElementById("errMsgSave").innerText="换绑与被换绑的人不能是同一个人";else{var n=o(),c=n.token,m=n.empCode,d=document.getElementById("codeFrom").getAttribute("data-empName"),a=document.getElementById("codeTo").getAttribute("data-empName"),u=confirm("确定将客户绑定的业务员由 "+d+" 更换为 "+a+" 吗?");1==u&&r("/wx-web/external/changeSalesman",{tokenId:c,userCode:m,empCode:e,changeEmpCode:t}).then(function(e){e&&"0"==e.errcode?alert("换绑成功"):document.getElementById("errMsgSave").innerHTML="换绑失败，请稍后重试"}).catch(function(e){console.error(e),document.getElementById("errMsgSave").innerHTML="换绑失败了，请稍后重试"})}else document.getElementById("errMsgTo").innerText="请输入并搜索换绑后的员工编号或手机号";else document.getElementById("errMsgFrom").innerText="请输入并搜索需要换绑的员工编号或手机号"}}Object.defineProperty(t,"__esModule",{value:!0});var a=n("3SZ7"),u=n.n(a),s=n("UIuv"),l=n.n(s);window.onload=function(){var e=o(),t=e.token,n=e.empCode;t&&n&&r("/wx-web/external/checkUser",{tokenId:t,empCode:n}).then(function(e){"0"==e.errcode?(console.log(e),d()):alert(e.errmsg)}).catch(function(e){console.error(e)})}}},["qq+V"]);